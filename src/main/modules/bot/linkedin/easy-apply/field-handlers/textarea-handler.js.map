{
  "version": 3,
  "sources": ["textarea-handler.ts"],
  "sourcesContent": ["/**\n * Textarea Handler - Handles multi-line text areas\n * \n * Used for questions like:\n * - \"Tell us about yourself\"\n * - \"Why are you interested in this role?\"\n * - Cover letter text\n */\n\nimport type { Locator } from 'playwright';\nimport { BaseFieldHandler } from './base-handler';\nimport { createLogger } from '../../../utils/logger';\n\nconst log = createLogger('TextareaHandler');\n\nexport class TextareaHandler extends BaseFieldHandler {\n  /**\n   * Check if this element contains a textarea\n   */\n  async canHandle(element: Locator): Promise<boolean> {\n    try {\n      const count = await element.locator('textarea').count();\n      return count > 0;\n    } catch {\n      return false;\n    }\n  }\n\n  /**\n   * Handle a textarea field\n   */\n  async handle(element: Locator): Promise<boolean> {\n    try {\n      const textarea = element.locator('textarea').first();\n      if (await textarea.count() === 0) return false;\n\n      // Get question text\n      const questionText = await this.extractQuestionText(element);\n      log.debug(`Question: \"${questionText}\"`);\n\n      // Always clear and get fresh answer from GPT (don't trust prefill)\n      const existingValue = await textarea.inputValue();\n      if (existingValue?.trim()) {\n        log.debug(`Clearing existing content: [${existingValue.length} chars]`);\n      }\n\n      // Get answer from GPT (textareas are usually open-ended)\n      log.debug(`Asking GPT for long-form answer: \"${questionText}\"`);\n      const answer = await this.gptAnswerer.answerTextual(questionText);\n\n      if (!answer?.trim()) {\n        log.warn('No answer available for textarea');\n        return false;\n      }\n\n      log.info(`\u2705 Q: \"${questionText}\" \u2192 [${answer.length} chars]`);\n\n      // Fill the textarea\n      await textarea.click();\n      await textarea.fill(''); // Clear first\n      await textarea.fill(answer);\n      await this.page.waitForTimeout(300);\n\n      // Remember answer\n      this.formUtils.rememberAnswer('textarea', questionText, answer);\n\n      // Check for validation errors\n      const errorMsg = await this.formUtils.extractFieldErrors(element);\n      if (errorMsg) {\n        log.warn(`Validation error: ${errorMsg}`);\n        \n        const retryAnswer = await this.gptAnswerer.answerTextualWithRetry(\n          questionText, answer, errorMsg\n        );\n        \n        if (retryAnswer) {\n          await textarea.fill('');\n          await textarea.fill(retryAnswer);\n          this.formUtils.rememberAnswer('textarea', questionText, retryAnswer);\n        }\n      }\n\n      return true;\n\n    } catch (error) {\n      log.error(`Error handling textarea: ${error}`);\n      return false;\n    }\n  }\n}\n"],
  "mappings": "AAUA,SAAS,wBAAwB;AACjC,SAAS,oBAAoB;AAE7B,MAAM,MAAM,aAAa,iBAAiB;AAEnC,MAAM,wBAAwB,iBAAiB;AAAA;AAAA;AAAA;AAAA,EAIpD,MAAM,UAAU,SAAoC;AAClD,QAAI;AACF,YAAM,QAAQ,MAAM,QAAQ,QAAQ,UAAU,EAAE,MAAM;AACtD,aAAO,QAAQ;AAAA,IACjB,QAAQ;AACN,aAAO;AAAA,IACT;AAAA,EACF;AAAA;AAAA;AAAA;AAAA,EAKA,MAAM,OAAO,SAAoC;AAC/C,QAAI;AACF,YAAM,WAAW,QAAQ,QAAQ,UAAU,EAAE,MAAM;AACnD,UAAI,MAAM,SAAS,MAAM,MAAM,EAAG,QAAO;AAGzC,YAAM,eAAe,MAAM,KAAK,oBAAoB,OAAO;AAC3D,UAAI,MAAM,cAAc,YAAY,GAAG;AAGvC,YAAM,gBAAgB,MAAM,SAAS,WAAW;AAChD,UAAI,eAAe,KAAK,GAAG;AACzB,YAAI,MAAM,+BAA+B,cAAc,MAAM,SAAS;AAAA,MACxE;AAGA,UAAI,MAAM,qCAAqC,YAAY,GAAG;AAC9D,YAAM,SAAS,MAAM,KAAK,YAAY,cAAc,YAAY;AAEhE,UAAI,CAAC,QAAQ,KAAK,GAAG;AACnB,YAAI,KAAK,kCAAkC;AAC3C,eAAO;AAAA,MACT;AAEA,UAAI,KAAK,cAAS,YAAY,aAAQ,OAAO,MAAM,SAAS;AAG5D,YAAM,SAAS,MAAM;AACrB,YAAM,SAAS,KAAK,EAAE;AACtB,YAAM,SAAS,KAAK,MAAM;AAC1B,YAAM,KAAK,KAAK,eAAe,GAAG;AAGlC,WAAK,UAAU,eAAe,YAAY,cAAc,MAAM;AAG9D,YAAM,WAAW,MAAM,KAAK,UAAU,mBAAmB,OAAO;AAChE,UAAI,UAAU;AACZ,YAAI,KAAK,qBAAqB,QAAQ,EAAE;AAExC,cAAM,cAAc,MAAM,KAAK,YAAY;AAAA,UACzC;AAAA,UAAc;AAAA,UAAQ;AAAA,QACxB;AAEA,YAAI,aAAa;AACf,gBAAM,SAAS,KAAK,EAAE;AACtB,gBAAM,SAAS,KAAK,WAAW;AAC/B,eAAK,UAAU,eAAe,YAAY,cAAc,WAAW;AAAA,QACrE;AAAA,MACF;AAEA,aAAO;AAAA,IAET,SAAS,OAAO;AACd,UAAI,MAAM,4BAA4B,KAAK,EAAE;AAC7C,aAAO;AAAA,IACT;AAAA,EACF;AACF;",
  "names": []
}
