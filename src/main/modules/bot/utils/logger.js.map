{
  "version": 3,
  "sources": ["logger.ts"],
  "sourcesContent": ["/**\n * Bot Logger - Consistent logging for the LinkedIn Auto Apply Bot\n * \n * Logs to both console and a persistent file for debugging and troubleshooting.\n * Log file location:\n * - Windows: %APPDATA%/jobelix/logs/bot.log\n * - macOS: ~/Library/Logs/jobelix/bot.log\n * - Linux: ~/.config/jobelix/logs/bot.log\n */\n\nimport * as fs from 'fs';\nimport * as path from 'path';\nimport { app } from 'electron';\n\ntype LogLevel = 'debug' | 'info' | 'warn' | 'error';\n\nconst LOG_LEVELS: Record<LogLevel, number> = {\n  debug: 0,\n  info: 1,\n  warn: 2,\n  error: 3,\n};\n\nclass BotLogger {\n  private level: LogLevel = 'info';\n  private prefix = '[Bot]';\n  private logFilePath: string | null = null;\n  private logStream: fs.WriteStream | null = null;\n\n  constructor() {\n    this.initializeLogFile();\n  }\n\n  /**\n   * Initialize the log file with proper path and rotation\n   */\n  private initializeLogFile(): void {\n    try {\n      // Get app data directory (works in both dev and production)\n      const logDir = path.join(app.getPath('userData'), 'logs');\n      \n      // Ensure logs directory exists\n      if (!fs.existsSync(logDir)) {\n        fs.mkdirSync(logDir, { recursive: true });\n      }\n\n      // Create log file path with date suffix for daily rotation\n      const dateStr = new Date().toISOString().split('T')[0]; // YYYY-MM-DD\n      this.logFilePath = path.join(logDir, `bot-${dateStr}.log`);\n\n      // Create write stream in append mode\n      this.logStream = fs.createWriteStream(this.logFilePath, { flags: 'a' });\n\n      // Log initialization\n      const initMsg = `\\n${'='.repeat(80)}\\nBot Logger Initialized: ${new Date().toISOString()}\\nLog file: ${this.logFilePath}\\n${'='.repeat(80)}\\n`;\n      this.logStream.write(initMsg);\n\n      console.info(`[BotLogger] Logging to: ${this.logFilePath}`);\n    } catch (error) {\n      console.error('[BotLogger] Failed to initialize log file:', error);\n      this.logFilePath = null;\n      this.logStream = null;\n    }\n  }\n\n  /**\n   * Write message to log file\n   */\n  private writeToFile(message: string): void {\n    if (this.logStream && !this.logStream.destroyed) {\n      this.logStream.write(message + '\\n');\n    }\n  }\n\n  /**\n   * Close log file stream (call on app shutdown)\n   */\n  close(): void {\n    if (this.logStream && !this.logStream.destroyed) {\n      this.logStream.end();\n      this.logStream = null;\n    }\n  }\n\n  setLevel(level: LogLevel): void {\n    this.level = level;\n  }\n\n  setPrefix(prefix: string): void {\n    this.prefix = prefix;\n  }\n\n  private shouldLog(level: LogLevel): boolean {\n    return LOG_LEVELS[level] >= LOG_LEVELS[this.level];\n  }\n\n  private formatMessage(level: LogLevel, message: string, context?: string): string {\n    const timestamp = new Date().toISOString();\n    const ctx = context ? `[${context}]` : '';\n    return `${timestamp} ${this.prefix} ${ctx} ${level.toUpperCase()}: ${message}`;\n  }\n\n  debug(message: string, context?: string): void {\n    if (this.shouldLog('debug')) {\n      const formatted = this.formatMessage('debug', message, context);\n      console.debug(formatted);\n      this.writeToFile(formatted);\n    }\n  }\n\n  info(message: string, context?: string): void {\n    if (this.shouldLog('info')) {\n      const formatted = this.formatMessage('info', message, context);\n      console.info(formatted);\n      this.writeToFile(formatted);\n    }\n  }\n\n  warn(message: string, context?: string): void {\n    if (this.shouldLog('warn')) {\n      const formatted = this.formatMessage('warn', message, context);\n      console.warn(formatted);\n      this.writeToFile(formatted);\n    }\n  }\n\n  error(message: string, context?: string, error?: Error): void {\n    if (this.shouldLog('error')) {\n      const formatted = this.formatMessage('error', message, context);\n      console.error(formatted);\n      this.writeToFile(formatted);\n      if (error?.stack) {\n        console.error(error.stack);\n        this.writeToFile(`Stack trace: ${error.stack}`);\n      }\n    }\n  }\n\n  /**\n   * Get the current log file path\n   */\n  getLogFilePath(): string | null {\n    return this.logFilePath;\n  }\n}\n\n// Singleton instance\nexport const logger = new BotLogger();\n\n// Convenience function for module-specific loggers\nexport function createLogger(context: string) {\n  return {\n    debug: (msg: string) => logger.debug(msg, context),\n    info: (msg: string) => logger.info(msg, context),\n    warn: (msg: string) => logger.warn(msg, context),\n    error: (msg: string, err?: Error) => logger.error(msg, context, err),\n  };\n}\n\n// Cleanup on app quit\napp.on('will-quit', () => {\n  logger.close();\n});\n"],
  "mappings": "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",
  "names": []
}
