{
  "version": 3,
  "sources": ["resume.ts"],
  "sourcesContent": ["/**\n * Resume Model - Loads and manages resume data from YAML\n * \n * Mirrors the Python Resume class for compatibility.\n */\n\nimport * as fs from 'fs';\nimport * as yaml from 'js-yaml';\nimport type { \n  Resume, \n  PersonalInformation, \n  SelfIdentification,\n  LegalAuthorization,\n  WorkPreferences,\n  Education,\n  Experience,\n  Availability,\n  SalaryExpectations,\n  Language \n} from '../types';\nimport { createLogger } from '../utils/logger';\n\nconst log = createLogger('ResumeModel');\n\n/**\n * Load and parse a resume from YAML file\n */\nexport function loadResume(resumePath: string): Resume {\n  log.info(`Loading resume from: ${resumePath}`);\n  \n  if (!fs.existsSync(resumePath)) {\n    throw new Error(`Resume file not found: ${resumePath}`);\n  }\n\n  const content = fs.readFileSync(resumePath, 'utf-8');\n  return parseResumeYaml(content);\n}\n\n/**\n * Parse resume YAML content into Resume object\n */\nexport function parseResumeYaml(content: string): Resume {\n  const data = yaml.load(content) as Record<string, unknown>;\n  \n  // Handle both new JSON Resume format and legacy format\n  const basics = (data.basics || data.personal_information || {}) as Record<string, unknown>;\n  const work = (data.work || data.experience_details || []) as Record<string, unknown>[];\n  const education = (data.education || data.education_details || []) as Record<string, unknown>[];\n  \n  const resume: Resume = {\n    personalInformation: parsePersonalInformation(basics, data),\n    selfIdentification: parseSelfIdentification(data.self_identification as Record<string, unknown>),\n    legalAuthorization: parseLegalAuthorization(data.legal_authorization as Record<string, unknown>),\n    workPreferences: parseWorkPreferences(data.work_preferences as Record<string, unknown>),\n    educationDetails: education.map(parseEducation),\n    experienceDetails: work.map(parseExperience),\n    availability: parseAvailability(data.availability as Record<string, unknown>),\n    salaryExpectations: parseSalaryExpectations(data.salary_expectations as Record<string, unknown>),\n    languages: parseLanguages(data.languages as Record<string, unknown>[]),\n    interests: data.interests as string | undefined,\n    achievements: data.achievements as string[] | undefined,\n    certifications: data.certifications as string[] | undefined,\n    skills: parseSkills(data.skills),\n  };\n\n  log.info(`Resume loaded: ${resume.personalInformation.name} ${resume.personalInformation.surname}`);\n  return resume;\n}\n\nfunction parsePersonalInformation(basics: Record<string, unknown>, _root: Record<string, unknown>): PersonalInformation {\n  const location = (basics.location || {}) as Record<string, unknown>;\n  \n  return {\n    name: (basics.name as string)?.split(' ')[0] || '',\n    surname: (basics.name as string)?.split(' ').slice(1).join(' ') || '',\n    dateOfBirth: basics.dateOfBirth as string || '',\n    country: location.countryCode as string || location.country as string || '',\n    city: location.city as string || '',\n    phone: basics.phone as string || '',\n    phonePrefix: basics.phonePrefix as string || extractPhonePrefix(basics.phone as string),\n    email: basics.email as string || '',\n    github: extractProfile(basics.profiles, 'github') || basics.github as string || '',\n    linkedin: extractProfile(basics.profiles, 'linkedin') || basics.linkedin as string || '',\n  };\n}\n\nfunction extractPhonePrefix(phone: string | undefined): string {\n  if (!phone) return '';\n  const match = phone.match(/^\\+(\\d{1,3})/);\n  return match ? `+${match[1]}` : '';\n}\n\nfunction extractProfile(profiles: unknown, network: string): string {\n  if (!Array.isArray(profiles)) return '';\n  const profile = profiles.find((p: Record<string, unknown>) => \n    (p.network as string)?.toLowerCase() === network\n  );\n  return profile?.url as string || '';\n}\n\nfunction parseSelfIdentification(data: Record<string, unknown> | undefined): SelfIdentification {\n  return {\n    gender: data?.gender as string || '',\n    pronouns: data?.pronouns as string || 'they/them',\n    veteran: data?.veteran as string || 'No',\n    disability: data?.disability as string || 'No',\n    ethnicity: data?.ethnicity as string || '',\n  };\n}\n\nfunction parseLegalAuthorization(data: Record<string, unknown> | undefined): LegalAuthorization {\n  return {\n    euWorkAuthorization: data?.euWorkAuthorization as string || 'Yes',\n    usWorkAuthorization: data?.usWorkAuthorization as string || 'No',\n    requiresUsVisa: data?.requiresUsVisa as string || 'Yes',\n    legallyAllowedToWorkInUs: data?.legallyAllowedToWorkInUs as string || 'No',\n    requiresUsSponsorship: data?.requiresUsSponsorship as string || 'Yes',\n    requiresEuVisa: data?.requiresEuVisa as string || 'No',\n    legallyAllowedToWorkInEu: data?.legallyAllowedToWorkInEu as string || 'Yes',\n    requiresEuSponsorship: data?.requiresEuSponsorship as string || 'No',\n  };\n}\n\nfunction parseWorkPreferences(data: Record<string, unknown> | undefined): WorkPreferences {\n  return {\n    remoteWork: data?.remoteWork as string || 'Yes',\n    inPersonWork: data?.inPersonWork as string || 'Yes',\n    openToRelocation: data?.openToRelocation as string || 'Yes',\n    willingToCompleteAssessments: data?.willingToCompleteAssessments as string || 'Yes',\n    willingToUndergoDrugTests: data?.willingToUndergoDrugTests as string || 'Yes',\n    willingToUndergoBackgroundChecks: data?.willingToUndergoBackgroundChecks as string || 'Yes',\n  };\n}\n\nfunction parseEducation(data: Record<string, unknown>): Education {\n  return {\n    degree: data.studyType as string || data.degree as string || '',\n    university: data.institution as string || data.university as string || '',\n    graduationYear: data.endDate as string || data.graduationYear as string || '',\n    fieldOfStudy: data.area as string || data.fieldOfStudy as string || '',\n    gpa: data.gpa as string,\n  };\n}\n\nfunction parseExperience(data: Record<string, unknown>): Experience {\n  const startDate = data.startDate as string || '';\n  const endDate = data.endDate as string || 'Present';\n  \n  // Parse highlights into key responsibilities\n  const highlights = (data.highlights || []) as string[];\n  const keyResponsibilities: Record<string, string> = {};\n  highlights.forEach((h, i) => {\n    keyResponsibilities[`responsibility_${i + 1}`] = h;\n  });\n\n  return {\n    position: data.position as string || data.title as string || '',\n    company: data.name as string || data.company as string || '',\n    employmentPeriod: `${startDate} - ${endDate}`,\n    location: data.location as string || '',\n    industry: data.industry as string,\n    keyResponsibilities,\n    skillsAcquired: {},\n  };\n}\n\nfunction parseAvailability(data: Record<string, unknown> | undefined): Availability {\n  return {\n    noticePeriod: data?.noticePeriod as string || '2 weeks',\n  };\n}\n\nfunction parseSalaryExpectations(data: Record<string, unknown> | undefined): SalaryExpectations {\n  return {\n    salaryRangeUSD: data?.salaryRangeUSD as string || '',\n  };\n}\n\nfunction parseLanguages(data: Record<string, unknown>[] | undefined): Language[] {\n  if (!Array.isArray(data)) return [];\n  return data.map(lang => ({\n    language: lang.language as string || '',\n    proficiency: lang.fluency as string || lang.proficiency as string || '',\n  }));\n}\n\nfunction parseSkills(data: unknown): string[] {\n  if (!data) return [];\n  if (Array.isArray(data)) {\n    return data.map(s => {\n      if (typeof s === 'string') return s;\n      if (typeof s === 'object' && s !== null) {\n        return (s as Record<string, unknown>).name as string || '';\n      }\n      return '';\n    }).filter(Boolean);\n  }\n  return [];\n}\n\n/**\n * Convert resume to a narrative string for LLM context\n */\nexport function resumeToNarrative(resume: Resume): string {\n  const { personalInformation: pi, experienceDetails, educationDetails, skills } = resume;\n  \n  let narrative = `${pi.name} ${pi.surname} is a professional`;\n  \n  if (experienceDetails.length > 0) {\n    const recent = experienceDetails[0];\n    narrative += ` currently working as ${recent.position} at ${recent.company}`;\n  }\n  \n  if (pi.city && pi.country) {\n    narrative += `, based in ${pi.city}, ${pi.country}`;\n  }\n  \n  narrative += '.\\n\\n';\n  \n  // Experience\n  if (experienceDetails.length > 0) {\n    narrative += 'Work Experience:\\n';\n    for (const exp of experienceDetails) {\n      narrative += `- ${exp.position} at ${exp.company} (${exp.employmentPeriod})\\n`;\n      const responsibilities = Object.values(exp.keyResponsibilities).slice(0, 3);\n      for (const r of responsibilities) {\n        narrative += `  \u2022 ${r}\\n`;\n      }\n    }\n    narrative += '\\n';\n  }\n  \n  // Education\n  if (educationDetails.length > 0) {\n    narrative += 'Education:\\n';\n    for (const edu of educationDetails) {\n      narrative += `- ${edu.degree} in ${edu.fieldOfStudy} from ${edu.university} (${edu.graduationYear})\\n`;\n    }\n    narrative += '\\n';\n  }\n  \n  // Skills\n  if (skills && skills.length > 0) {\n    narrative += `Skills: ${skills.join(', ')}\\n`;\n  }\n  \n  return narrative;\n}\n\n/**\n * Get a specific section of the resume for LLM context\n */\nexport function getResumeSection(resume: Resume, section: string): string {\n  switch (section) {\n    case 'personal_information':\n      return JSON.stringify(resume.personalInformation, null, 2);\n    case 'self_identification':\n      return JSON.stringify(resume.selfIdentification, null, 2);\n    case 'legal_authorization':\n      return JSON.stringify(resume.legalAuthorization, null, 2);\n    case 'work_preferences':\n      return JSON.stringify(resume.workPreferences, null, 2);\n    case 'education_details':\n      return JSON.stringify(resume.educationDetails, null, 2);\n    case 'experience_details':\n      return JSON.stringify(resume.experienceDetails, null, 2);\n    case 'availability':\n      return JSON.stringify(resume.availability, null, 2);\n    case 'salary_expectations':\n      return JSON.stringify(resume.salaryExpectations, null, 2);\n    case 'languages':\n      return JSON.stringify(resume.languages, null, 2);\n    case 'interests':\n      return resume.interests || '';\n    case 'cover_letter':\n      return resumeToNarrative(resume);\n    default:\n      return resumeToNarrative(resume);\n  }\n}\n"],
  "mappings": "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",
  "names": []
}
